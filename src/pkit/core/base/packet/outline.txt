1. 包捕获，直接利用 p4 解析数据，唯一的需求就是动态适应
2. 包构造，先确定第一批次支持的包类型，直接写出模板，保存模板到内存，模板部分字段支持更改，即可
3. 至于包的额外信息，额外信息通过 map 联系数据包，最后交由包组管理
4. 包修改及重放保存先不管
包直接映射到组内，组也直接映射到网卡
包捕获后的处理，主要是协议类型未知是个难题
包构造的存储需要用到对象存储加载技术
packet -> group -> interface

包组提供生成其它类型组的方法，如将此组中的 tcp 包提取出生成另一个 组
因此，数据包与组的关系是多对多的
而组与接口的关系为多对一

parser 作用是解析 p4 的数据，如 ip 头部，
这样的话，捕获之后的信息可直接按照 p4 的组织方式存入数据库，即动态字段部分直接存为字符串


└ ─ ─





